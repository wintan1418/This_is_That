<div class="max-w-4xl mx-auto px-4 py-12">
  <!-- Back Link -->
  <%= link_to "â† Back", :back, class: "text-gray-400 hover:text-white mb-6 inline-block" %>

  <div class="bg-white/5 border border-white/10 rounded-3xl overflow-hidden">
    <!-- Header Image -->
    <% if @place.image_url.present? %>
      <div class="h-64 bg-cover bg-center" style="background-image: url('<%= @place.image_url %>')"></div>
    <% else %>
      <div class="h-64 bg-gradient-to-br from-purple-500/20 to-pink-500/20 flex items-center justify-center">
        <span class="text-8xl"><%= @place.category&.icon || "ðŸ“" %></span>
      </div>
    <% end %>

    <!-- Content -->
    <div class="p-8">
      <!-- Title & Actions -->
      <div class="flex items-start justify-between gap-4 mb-6">
        <div>
          <h1 class="text-3xl font-bold mb-2"><%= @place.name %></h1>
          <p class="text-gray-400"><%= @place.full_address %></p>
        </div>
        
        <% if user_signed_in? && @place.user == current_user %>
          <div class="flex gap-2">
            <%= link_to "Edit", edit_place_path(@place), class: "px-4 py-2 bg-white/10 rounded-lg hover:bg-white/20 transition-colors" %>
            <%= button_to "Delete", place_path(@place), method: :delete, data: { turbo_confirm: "Are you sure?" }, class: "px-4 py-2 bg-red-500/20 text-red-400 rounded-lg hover:bg-red-500/30 transition-colors" %>
          </div>
        <% end %>
      </div>

      <!-- Info Grid -->
      <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
        <% if @place.rating %>
          <div class="p-4 bg-white/5 rounded-xl text-center">
            <div class="text-2xl font-bold text-yellow-400">â˜… <%= @place.rating %></div>
            <div class="text-sm text-gray-500">Rating</div>
          </div>
        <% end %>
        <% if @place.price %>
          <div class="p-4 bg-white/5 rounded-xl text-center">
            <div class="text-2xl font-bold text-green-400"><%= @place.price %></div>
            <div class="text-sm text-gray-500">Price</div>
          </div>
        <% end %>
        <% if @place.category %>
          <div class="p-4 bg-white/5 rounded-xl text-center">
            <div class="text-2xl font-bold"><%= @place.category.icon %></div>
            <div class="text-sm text-gray-500"><%= @place.category.name %></div>
          </div>
        <% end %>
        <div class="p-4 bg-white/5 rounded-xl text-center">
          <div class="text-2xl font-bold text-purple-400"><%= @place.reviews.count %></div>
          <div class="text-sm text-gray-500">Reviews</div>
        </div>
      </div>

      <!-- Map -->
      <% if @place.latitude.present? && @place.longitude.present? %>
        <div class="h-64 w-full bg-slate-900 rounded-xl overflow-hidden mb-8 border border-white/10 relative z-0"
             data-controller="map"
             data-map-latitude-value="<%= @place.latitude %>"
             data-map-longitude-value="<%= @place.longitude %>"
             data-map-name-value="<%= @place.name %>">
        </div>
      <% end %>

      <!-- External Links -->
      <% if @place.url.present? || @place.phone.present? %>
        <div class="flex gap-4 mb-8">
          <% if @place.url %>
            <%= link_to @place.url, target: "_blank", class: "px-4 py-2 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg hover:opacity-90 transition-opacity" do %>
              View on Yelp â†’
            <% end %>
          <% end %>
          <% if @place.phone %>
            <%= link_to "tel:#{@place.phone}", class: "px-4 py-2 bg-white/10 rounded-lg hover:bg-white/20 transition-colors" do %>
              ðŸ“ž <%= @place.phone %>
            <% end %>
          <% end %>
        </div>
      <% end %>
    </div>
  </div>

  <!-- Reviews Section -->
  <div class="mt-8">
    <h2 class="text-2xl font-bold mb-6">Reviews (<%= @place.reviews.count %>)</h2>
    
    <!-- Add Review Form -->
    <% if user_signed_in? %>
      <div class="p-6 bg-white/5 border border-white/10 rounded-2xl mb-6">
        <h3 class="font-semibold mb-4">Write a Review</h3>
        <%= form_with model: @review, url: place_reviews_path(@place), class: "space-y-4" do |f| %>
          <div>
            <label class="block text-sm text-gray-400 mb-2">Rating</label>
            <div class="flex gap-2">
              <% (1..5).each do |n| %>
                <label class="cursor-pointer">
                  <%= f.radio_button :rating, n, class: "hidden peer" %>
                  <span class="text-2xl peer-checked:scale-125 transition-transform">â˜…</span>
                </label>
              <% end %>
            </div>
          </div>
          <div>
            <label class="block text-sm text-gray-400 mb-2">Your Review</label>
            <%= f.text_area :content, rows: 3, placeholder: "Share your experience...", class: "w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500" %>
          </div>
          <%= f.submit "Submit Review", class: "px-6 py-2 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg cursor-pointer hover:opacity-90 transition-opacity" %>
        <% end %>
      </div>
    <% end %>

    <!-- Reviews List -->
    <% if @reviews.any? %>
      <div class="space-y-4">
        <% @reviews.each do |review| %>
          <div class="p-6 bg-white/5 border border-white/10 rounded-2xl">
            <div class="flex items-center justify-between mb-3">
              <div class="flex items-center gap-3">
                <div class="w-10 h-10 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center font-semibold">
                  <%= review.user.name&.first&.upcase || review.user.email.first.upcase %>
                </div>
                <div>
                  <div class="font-medium"><%= review.user.name || review.user.email.split('@').first %></div>
                  <div class="text-sm text-gray-500"><%= time_ago_in_words(review.created_at) %> ago</div>
                </div>
              </div>
              <div class="text-yellow-400"><%= review.rating_stars %></div>
            </div>
            <p class="text-gray-300"><%= review.content %></p>
          </div>
        <% end %>
      </div>
    <% else %>
      <div class="p-8 bg-white/5 border border-white/10 rounded-2xl text-center">
        <p class="text-gray-400">No reviews yet. Be the first to share your experience!</p>
      </div>
    <% end %>
  </div>
</div>
